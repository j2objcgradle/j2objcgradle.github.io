# Testing

> See other tutorials: [Basic Quick Start](/basicquickstart.html), [Dependencies](/basicsamples/dependencies.html)

Along with translating your shared code, you can translate tests to Objective-C and run them in Xcode.
The test translation works in a very similar way to the main shared code translation.
The files matched with j2objcConfig's translatePattern are put through j2objc.

A separate podspec is created for test support: testj2objclib.podspec.

## Xcode Config

Inside Xcode, we actually create a separate application target, 'iosTestOnly', rather than
putting tests in a unit test target. Cocoapods doesn't allow local podspecs
to depend on other local podspecs, so to avoid dependency issues, create a separate
application target.

```ruby
platform :ios, '9.0'

install! 'cocoapods',
           :deterministic_uuids => false

target 'ios' do
  use_frameworks!
  pod 'j2objclib', :path => '../app'
end

target 'iosTestOnly' do
  use_frameworks!
  pod 'testj2objclib', :path => '../app'
end
```

## Doppl Testing Support

There is a testing support package that is part of the [Doppl suite](https://github.com/doppllib/core-doppl) which we'll be
using to assist in running tests. You can either pass in a list of tests to run directly, or give the method
a filename which contains a list of tests to run.

In the Xcode sample project, see iosTestOnly/ViewController.swift.

```swift
import UIKit
import testj2objclib

class ViewController: UIViewController {
    override func viewDidLoad() {
        super.viewDidLoad()
        CoTouchlabDopplTestingDopplJunitTestHelper.runResource(with: "j2objcTests.txt")
    }
}
```

The file 'j2objcTests.txt' is generated by the Gradle plugin. It lists tests that are matched
with 'translatePattern' and also match the filename pattern "&#42;&#42;/&#42;Test.java".
If you change this value in j2objcConfig by setting testIdentifier, although most projects
Seem to follow the &#42;Test.java convention.

```groovy
j2objcConfig {
    translatePattern {
        include '**/shared/**'
    }
    testIdentifier {
      "**/*Test.java"
      "**/*Tests.java"
      "**/*OtherSuffix.java"
    }
}
```

The file 'j2objcTests.txt' will be in the build directory,
and needs to be manually added to Xcode for it to be visible.

## XCTestCase

When building and running tests its generally easier to run them from
AppDelegate or ViewController, because the log output will go into the log panel,
but to automate builds easier, you can call tests from an XCTestCase.

```swift
import XCTest
import testj2objclib

class iosTestOnlyTests: XCTestCase {  
    func testJ2objcCode() {
        XCTAssertEqual(CoTouchlabDopplTestingDopplJunitTestHelper.runResource(with: "j2objcTests.txt"), 0)
    }
}
```

You can also automate the test running process once it's set up in Xcode with something like the following:

```groovy
task runIOSTests(type:Exec, dependsOn: 'j2objcBuild') {
    workingDir '../ios'
    commandLine 'xcodebuild', 'test', '-workspace', 'ios.xcworkspace', '-scheme', 'iosTestOnly', '-destination', 'platform=iOS Simulator,name=iPhone 7,OS=latest'
}
```
